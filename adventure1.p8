pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
	state="start"
	putbacks={}
	setup_game()
end

function _draw()
	cls()
		if state=="play" then
			map()	
			aniplayer()
			pickups()
			draw_ui()
			dcam()
		elseif state=="start" then
			print("press ❎ to start",cam_x,cam_y)
		elseif state=="win" then
			print("you win!",cam_x,cam_y)
		end
end

function _update()
	if state=="play" then
		move_player()
	elseif state=="start" then
		if btnp(❎) then
			state="play"
		end
	elseif state=="win" then
		if btnp(❎) then
			setup_game()		
			state="start"
  end
 end
end

function setup_game()
	px=5
	py=5
	pf=2 --player frame
	flp=false --sprite flipped?
	goal=2 --how many sodas?
	init_ui()
	
	for t in all(putbacks) do
		mset(t[1],t[2],20)
	end
	putbacks={}
end
-->8
--animation--
function aniplayer()
	
	if pf>3.9 then
		pf=2
	else
		pf+=.1
	end
	
	
	spr(pf,px,py,1,1,flp)
end
-->8
--pickups--

function pickups()

	local ptx=(px+4)/8
	local pty=(py+4)/8
	
	spover=mget(ptx,pty)

	if spover==20 then
		mset(ptx,pty,17)
		
		add(putbacks,{ptx,pty})
		
		sodas+=1
		if sodas>=goal then
			state="win"
		end
	end
	
end
-->8
--points/ui--
function init_ui()
	sodas=0
end


function draw_ui()
	print("sodas: "..sodas)
end
-->8
--player movement--

function move_player()

	local lx=px
	local ly=py

	if btn(⬅️) then
		px-=1
		flp=true
	elseif btn(➡️) then
		px+=1
		flp=false
	elseif btn(⬆️) then
		py-=1
	elseif btn(⬇️) then
		py+=1
	end
	
	local ptx=(px+4)/8
	local pty=(py+4)/8
	
 --is the player over a tile
 --that has flag o?
 	
	if fget(mget(ptx,pty),0)==true then
		px=lx
		py=ly
	end

end
-->8
--camera--
function dcam()
	cam_x=px-60
	cam_y=py-60
	
	cam_x=mid(0,cam_x,896)
	cam_y=mid(0,cam_y1,128)
	
	camera(cam_x,cam_y)
end
__gfx__
00000000334444333344443333444433333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000034ffff433441141334411413333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070033f1f1334447111444471114333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700033ffff334447171444471714333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000f111d11f4444444444444444333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700331111333444444334444443333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000003311d1333111ff133111ff13333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000332332333111111331311333333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333331dddddd1333333333333333300000000000000003333332222333333333333333333333333333333333333333333ee833333333300000000
0000000033333e33dddddddd33333333333663330000000000000000332233222233223333bbbbbbbbbbbb333333333bb3333333333e88e83333333300000000
000000003a333333dd4ddddd3444443333666633000000000000000033223322223322333bbbbbbbbbbbbbb3333333bbbb33333333e8e88e8333333300000000
0000000033333333dddddddd34f1f433339669330000000000000000222222dddd2222223bbbbbbbbbbbbbb333333bbbbbb333333e888e8ee833333300000000
0000000033333333dddddddd341f14333399a9330000000000000000222222dddd2222223bbbbbbbbbbbbbb333333bbbbbb3333332e888e22e83333300000000
0000000033d33333dddddddd333433333369a6330000000000000000ddddddee88dddddd3bbbbbbbbbbbbbb33333bbbbbbbb3333342e8e2992e8333300000000
0000000033333393ddddd4dd33343333333663330000000000000000ddddddee88dddddd3bbbbbbbbbbbbbb33333bbbbbbbb33333492e29ff92e333300000000
00000000333333331dddddd133343333333333330000000000000000dddddd8822dddddd3bbbbbbbbbbbbbb3333bbbbbbbbbb333349929ffff92333300000000
00000000000000000000000000000000000000000000000000000000dd00dd8822dd00dd3bbbbbbbbbbbbbb3333bbbbbbbbbb33334994f99fff4333300000000
00000000000000000000000000000000000000000000000000000000dd00dddddddd00dd3bbbbbbbbbbbbbb3333bbbbbbbbbb33334994f9afff4333300000000
00000000000000000000000000000000000000000000000000000000dd11dddddddd11dd33bb33333333bb33333bbbbbbbbbb33335994ffffff4333300000000
00000000000000000000000000000000000000000000000000000000dd11dddddddd11dd33333b3bb3b33333333bbbbbbbbbb33333594ffd1ff4333300000000
00000000000000000000000000000000000000000000000000000000dddddd8822dddddd333333bbbb3333333333bbbbbbbb333333354ffd1ff4333300000000
00000000000000000000000000000000000000000000000000000000dddddd8822dddddd3333333bb33333333333333333333333333355555555333300000000
00000000000000000000000000000000000000000000000000000000dddddd8822dddddd3333333bb33333333333333bb333333333333335d333333300000000
00000000000000000000000000000000000000000000000000000000dddddd8822dddddd3333333bb33333333333333bb33333333333333335d3333300000000
__gff__
0000000000000000000000000000000000000001000000010101010101010100000000000000000101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
04040404111111111111111b1c1b1c11191a191a191a11111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111171811111111112b2c2b2c11292a292a292a11111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111272811121212111111141111191a191a191a11111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111311111112111211191a111111292a292a292a191a1111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1b1c111111121212111211292a111111111111111111292a1111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2b2c111111111111111212121211111111111114111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
121212121211111b1c1111111211111b1c1b1c11111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111111111212112b2c1111111211112b2c2b2c111111111111191a1111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111211111111141112111111111111111111111111292a1111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111d1e11111211111111111111121212121212121211111111191a1111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
112d2e11111211111111191a11111111111111111212111111292a1111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111d1e1212121111292a1b1c1b1c1111111111121111111b1c1111111b1c1b1c1b1c1111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111112d2e111112121111112b2c2b2c1111141111121111112b2c1111112b2c2b2c2b2c1111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111121211111111191a11111111111111111111111111111b1c1b1c1b1c1111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111292a11111111111111111111111111112b2c2b2c2b2c1111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111111111111111111111b1c111111111111191a11111111111111111111111111111b1c1111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111d1e1d1e1d1e1111112b2c111111111111292a11191a111111111111111b1c11112b2c1111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
112d2e2d2e2d2e111b1c191a1111111b1c11111111292a111111111111112b2c111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111111112b2c292a1111112b2c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
